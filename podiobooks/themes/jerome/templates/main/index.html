{% extends "base.html" %}

{% load global_templatetags %}
{% load shelf_templatetags %}
{% load ad_templatetags %}
{% load title_templatetags %}

{% block headtitle %}{{block.super}} - Free Downloadable Audiobooks{% endblock %}

{% block body_class %}home{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ STATIC_URL }}css/flexslider.css" type="text/css">
{% endblock %}

{% block content %}

<h2 class='shelf-heading shelf-heading-dark'>Featured</h2>
{{category_choice_form.as_p}}
<div id="featured-shelf" class='shelf shelf-dark clearfix'>
    {% for title in featured_title_list %}
    {% show_shelf_item 'featured-shelf' title %}
    {% endfor %}
</div>

<h2 class='shelf-heading shelf-heading-light'>Top Authors</h2>
{{contributor_choice_form.as_p}}
<div id="top-rated-shelf" class='shelf shelf-light clearfix'>
    {% for title in toprated_title_list %}
    {% show_shelf_item 'top-rated-shelf' title %}
    {% endfor %}
</div>

<div class='half-shelf-wrap clearfix'>
    <div class='half-shelf'>
        <h2 class='shelf-heading shelf-heading-light'>Recently Completed</h2>

        <div id="recently-completed-shelf" class='shelf shelf-light clearfix'>
            {% for title in recentlycomplete_title_list %}
            {% show_shelf_item 'recently-completed-shelf' title %}
            {% endfor %}
        </div>
    </div>

    <div class='half-shelf clearfix'>
        <h2 class='shelf-heading shelf-heading-light'>Now Releasing</h2>

        <div id="now-releasing-shelf" class='shelf shelf-light clearfix'>
            {% for title in nowreleasing_title_list %}
            {% show_shelf_item 'now-releasing-shelf' title %}
            {% endfor %}
        </div>
    </div>
</div>

<div class='clearfix'></div>
{% endblock %}

{% block footerscripts %}
<script src="{{ STATIC_URL}}js/libs/jquery.flexslider-min.js"></script>
<script>
    $('#id_category').change(function () {
        $.ajax({
            url:"/lazy/featured/" + $('#id_category').val(),
            success:function (html) {
                $("#featured-shelf").html(html);
            }
        });
    });
    $('#id_contributor').change(function () {
        $.ajax({
            url:"/lazy/top-rated/" + $('#id_contributor').val(),
            success:function (html) {
                $("#top-rated-shelf").html(html);
            }
        });
    });
</script>
{% endblock %}